/// Configuration for smith-validation architectural rules
module SmithValidationConfig

import "pkl:/stdlib.pkl"

/// Severity levels for rule violations
enum Severity {
  low
  medium
  high
  critical
}

/// TCA Rules Configuration
class TCAConfig {
  /// Enable/disable all TCA rules
  enabled = Listing<Boolean>(true)

  /// Rule 1.1: Monolithic Features
  rule_1_1_MonolithicFeatures = TCA_Rule_1_1_MonolithicFeatures {}

  /// Rule 1.2: Closure Injection
  rule_1_2_ClosureInjection = TCA_Rule_1_2_ClosureInjection {}

  /// Rule 1.3: Code Duplication
  rule_1_3_CodeDuplication = TCA_Rule_1_3_CodeDuplication {}

  /// Rule 1.4: Unclear Organization
  rule_1_4_UnclearOrganization = TCA_Rule_1_4_UnclearOrganization {}

  /// Rule 1.5: Tightly Coupled State
  rule_1_5_TightlyCoupledState = TCA_Rule_1_5_TightlyCoupledState {}

  /// Rule 2.1: Error Handling
  rule_2_1_ErrorHandling = TCA_Rule_2_1_ErrorHandling {}

  /// Rule 2.2: Reducible Complexity
  rule_2_2_ReducibleComplexity = TCA_Rule_2_2_ReducibleComplexity {}
}

/// TCA Rule 1.1: Monolithic Features Configuration
class TCA_Rule_1_1_MonolithicFeatures {
  enabled = true
  severity = Severity.medium
  maxMethods = 30
  maxNestedTypes = 8
  maxProperties = 25
  maxEstimatedComplexity = 100
}

/// TCA Rule 1.2: Closure Injection Configuration
class TCA_Rule_1_2_ClosureInjection {
  enabled = true
  severity = Severity.high
  maxServiceClients = 8
  maxDependencyMethods = 15
  maxGlobalDependencies = 5
}

/// TCA Rule 1.3: Code Duplication Configuration
class TCA_Rule_1_3_CodeDuplication {
  enabled = true
  severity = Severity.medium
  minSimilarityThreshold = 0.85
  maxDuplicateLines = 10
}

/// TCA Rule 1.4: Unclear Organization Configuration
class TCA_Rule_1_4_UnclearOrganization {
  enabled = true
  severity = Severity.medium
  maxFeaturesPerFile = 5
  maxMixedResponsibilityClasses = 3
  maxNestedFeatures = 4
}

/// TCA Rule 1.5: Tightly Coupled State Configuration
class TCA_Rule_1_5_TightlyCoupledState {
  enabled = true
  severity = Severity.medium
  maxStateProperties = 20
  maxCrossFeatureReferences = 8
  maxDirectStateMutations = 15
}

/// TCA Rule 2.1: Error Handling Configuration
class TCA_Rule_2_1_ErrorHandling {
  enabled = true
  severity = Severity.high
  requireResultHandling = true
  maxUnhandledAsyncOperations = 0
  requireErrorState = true
}

/// TCA Rule 2.2: Reducible Complexity Configuration
class TCA_Rule_2_2_ReducibleComplexity {
  enabled = true
  severity = Severity.medium
  maxSwitchCases = 25
  maxNestingDepth = 6
  maxAsyncOperations = 7
}

/// SwiftUI Rules Configuration
class SwiftUIConfig {
  /// Enable/disable all SwiftUI rules
  enabled = Listing<Boolean>(true)

  /// Rule 1.1: View Body Complexity
  rule_1_1_ViewBodyComplexity = SwiftUI_Rule_1_1_ViewBodyComplexity {}

  /// Rule 1.2: State Management
  rule_1_2_StateManagement = SwiftUI_Rule_1_2_StateManagement {}
}

/// SwiftUI Rule 1.1: View Body Complexity Configuration
class SwiftUI_Rule_1_1_ViewBodyComplexity {
  enabled = true
  severity = Severity.medium
  maxViewBodyLines = 100
  maxNestingDepth = 8
  maxConditionalStatements = 15
  maxViewModifiers = 30
}

/// SwiftUI Rule 1.2: State Management Configuration
class SwiftUI_Rule_1_2_StateManagement {
  enabled = true
  severity = Severity.medium
  maxStateProperties = 12
  maxComplexStateProperties = 5
}

/// Performance Rules Configuration
class PerformanceConfig {
  /// Enable/disable all Performance rules
  enabled = Listing<Boolean>(true)

  /// Rule 1.1: Memory Management
  rule_1_1_MemoryManagement = Performance_Rule_1_1_MemoryManagement {}

  /// Rule 1.2: CPU Usage Patterns
  rule_1_2_CPUUsagePatterns = Performance_Rule_1_2_CPUUsagePatterns {}

  /// Rule 1.3: Performance Anti-Patterns
  rule_1_3_PerformanceAntiPatterns = Performance_Rule_1_3_PerformanceAntiPatterns {}

  /// Rule 1.4: Concurrency Issues
  rule_1_4_ConcurrencyIssues = Performance_Rule_1_4_ConcurrencyIssues {}
}

/// Performance Rule 1.1: Memory Management Configuration
class Performance_Rule_1_1_MemoryManagement {
  enabled = true
  severity = Severity.high
  maxRetainCycles = 5
  maxStrongReferences = 50
  maxMemoryAllocations = 100
}

/// Performance Rule 1.2: CPU Usage Patterns Configuration
class Performance_Rule_1_2_CPUUsagePatterns {
  enabled = true
  severity = Severity.medium
  maxNestedLoops = 3
  maxRecursiveDepth = 10
  maxComplexCalculations = 20
}

/// Performance Rule 1.3: Performance Anti-Patterns Configuration
class Performance_Rule_1_3_PerformanceAntiPatterns {
  enabled = true
  severity = Severity.medium
  maxStringConcatenations = 10
  maxForceCasts = 5
  maxLargeValueTypes = 20
}

/// Performance Rule 1.4: Concurrency Issues Configuration
class Performance_Rule_1_4_ConcurrencyIssues {
  enabled = true
  severity = Severity.high
  maxSharedResources = 10
  maxBlockingCalls = 5
  allowMainThreadOperations = false
}

/// General Architecture Rules Configuration
class GeneralConfig {
  /// Enable/disable all General rules
  enabled = Listing<Boolean>(true)

  /// Rule 1.1: Circular Dependencies
  rule_1_1_CircularDependencies = General_Rule_1_1_CircularDependencies {}

  /// Rule 1.2: Module Dependencies
  rule_1_2_ModuleDependencies = General_Rule_1_2_ModuleDependencies {}
}

/// General Rule 1.1: Circular Dependencies Configuration
class General_Rule_1_1_CircularDependencies {
  enabled = true
  severity = Severity.high
  maxDependencyDepth = 10
}

/// General Rule 1.2: Module Dependencies Configuration
class General_Rule_1_2_ModuleDependencies {
  enabled = true
  severity = Severity.medium
  maxImportsPerFile = 25
  maxDependencyDepth = 8
  maxModuleDependencies = 20
}

/// Per-domain configuration
domainConfig = DomainConfig {}

/// Domain-level configuration structure
class DomainConfig {
  /// TCA-specific configuration
  tca = TCAConfig {}

  /// SwiftUI-specific configuration
  swiftui = SwiftUIConfig {}

  /// Performance architecture configuration
  performance = PerformanceConfig {}

  /// General architecture configuration
  general = GeneralConfig {}
}

/// Global validation settings
globalSettings = GlobalSettings {}

/// Global settings
class GlobalSettings {
  /// Output format for reports
  outputFormat = "console" // "console", "json", "sarif"

  /// Include/exclude file patterns
  includePatterns = Listing<String>("**/*.swift")
  excludePatterns = Listing<String>(
    "**/*.generated.swift",
    "**/DerivedData/**",
    "**/build/**"
  )

  /// Maximum number of violations to report (0 = unlimited)
  maxViolations = 100

  /// Fail build if violations are found
  failOnViolations = false

  /// Minimum severity to report
  minSeverity = Severity.low
}